<!DOCTYPE html>
<html>
    <head>
        <title>CCC Samples - Waterfall chart</title>

        <meta name="svg.render.forceflash" content="true">

        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        <script type="text/javascript" src="cdf/Base.js"></script>
        <script type="text/javascript" src="cdf/jquery.js"></script>
        <script type="text/javascript" src="cdf/jquery.tooltip.js"></script>
        <script type="text/javascript" src="data/q01-01.js"></script>
        <script type="text/javascript" src="lib/protovis-d3.3.js"></script>
        <script type="text/javascript" src="lib/protovis-msie.js"></script>
        <script type="text/javascript" src="lib/jquery.tipsy.js"></script>
        <script type="text/javascript" src="lib/tipsy.js"></script>
        <link type="text/css" href="lib/tipsy.css" rel="stylesheet"/>

        <script type="text/javascript" src="def/def.js"></script>
        <script type="text/javascript" src="pvc/pvc.js"></script>
        <script type="text/javascript" src="pvc/pvc.text.js"></script>
        <script type="text/javascript" src="pvc/pvc.color.js"></script>
        
        <script type="text/javascript" src="pvc/data/_data.js"></script>
        <script type="text/javascript" src="pvc/data/meta/DimensionType.js"></script>
	    <script type="text/javascript" src="pvc/data/meta/ComplexType.js"></script>
	    <script type="text/javascript" src="pvc/data/translation/TranslationOper.js"></script>
	    <script type="text/javascript" src="pvc/data/translation/MatrixTranslationOper.js"></script>
	    <script type="text/javascript" src="pvc/data/translation/CrosstabTranslationOper.js"></script>
	    <script type="text/javascript" src="pvc/data/translation/RelationalTranslationOper.js"></script>
	    <script type="text/javascript" src="pvc/data/Atom.js"></script>
	    <script type="text/javascript" src="pvc/data/Complex.js"></script>
	    <script type="text/javascript" src="pvc/data/Datum.js"></script>
	    <script type="text/javascript" src="pvc/data/Dimension.js"></script>
	    <script type="text/javascript" src="pvc/data/Data.js"></script>
	    <script type="text/javascript" src="pvc/data/Data.load.js"></script>
	    <script type="text/javascript" src="pvc/data/Data.selected.js"></script>
	    <script type="text/javascript" src="pvc/data/GroupingSpec.js"></script>
	    <script type="text/javascript" src="pvc/data/GroupingOper.js"></script>
	    <script type="text/javascript" src="pvc/data/Data.operations.js"></script>
	    <script type="text/javascript" src="pvc/data/Data.compat.js"></script>
        
        <script type="text/javascript" src="pvc/visual/Role.js"></script>
	    <script type="text/javascript" src="pvc/visual/Scene.js"></script>
	    <script type="text/javascript" src="pvc/visual/sign/Sign.js"></script>
	    <script type="text/javascript" src="pvc/visual/sign/Dot.js"></script>
	    <script type="text/javascript" src="pvc/visual/sign/Line.js"></script>
	    <script type="text/javascript" src="pvc/visual/sign/Area.js"></script>
	    <script type="text/javascript" src="pvc/visual/Context.js"></script>
	    <script type="text/javascript" src="pvc/visual/CartesianAxis.js"></script>
	    
        <script type="text/javascript" src="pvc/pvcAbstract.js"></script>
        <script type="text/javascript" src="pvc/pvcBaseChart.js"></script>
        <script type="text/javascript" src="pvc/pvcBasePanel.js"></script>
        <script type="text/javascript" src="pvc/pvcMultiChartPanel.js"></script>
        <script type="text/javascript" src="pvc/pvcTitlePanel.js"></script>
        <script type="text/javascript" src="pvc/pvcLegendPanel.js"></script>
        <script type="text/javascript" src="pvc/pvcTimeseriesAbstract.js"></script>
        <script type="text/javascript" src="pvc/pvcCartesianAbstract.js"></script>
	    <script type="text/javascript" src="pvc/pvcGridDockingPanel.js"></script>
	    <script type="text/javascript" src="pvc/pvcCartesianGridDockingPanel.js"></script>
	    <script type="text/javascript" src="pvc/pvcCartesianAbstractPanel.js"></script>
	    <script type="text/javascript" src="pvc/pvcCategoricalAbstract.js"></script>
        <script type="text/javascript" src="pvc/pvcAxisPanel.js"></script>
        <script type="text/javascript" src="pvc/pvcWaterfallChart.js"></script>
        
        <!--    <link type="text/css" rel="stylesheet" href="blueprint/screen.css"/>-->
        <link type="text/css" rel="stylesheet" href="cdf/jquery.tooltip.css"/>
        <link type="text/css" rel="stylesheet" href="pvcComponent.css"/>
        
        <script type="text/javascript" src="pvcDocUtils.js"></script>

    </head>
    <body>

<h1>Waterfall Chart</h1>
The waterfall charts are an alternative to pie charts for displaying distributions.
However when it's time to compare the size of categories and sub-categories, 
waterfall are the most convenient representation:<br>
While in a pie-chart you would have to compare wedges at different angles, 
in a waterfall chart you just compare the size of bars as all bars are parallel to one another.
<br/>


<h2>Chart Options</h2>
<h4>Dimensions</h4>
<ul>
  <li>width</li>
  <li>height</li>
  <li>margins -
      css-like margins shorthand syntax (without units) or object with properties 'all', 'top', 'bottom', 'left' and/or 'right'.
      Margins consume the chart's width and height (inside margins).
  </li>
</ul>
<h4>Title properties</h4>
<ul>
  <li>title</li>
  <li>titlePosition</li>
  <li>titleSize</li>
</ul>
<h4>Lifecycle</h4>
<ul>
  <li>renderCallback - executed immediatly before render is called</li>
</ul>
<h4>Legend properties</h4>
<ul>
  <li>legend (true|false)</li>
  <li>legendPosition (right, top, bottom, left)</li>
  <li>legendAlign (right, left, center, top, middle, bottom)</li>
  <li>legendSize</li>
  <li>legendDrawLine (true|false)</li>
  <li>legendDrawMarker (true|false)</li>
  <li>showTooltips (true|false)</li>
</ul>

<h4>Waterfall properties</h4>
<ul>
  <li>orientation - horizontal or vertical. Default: vertical</li>
  <li>showValues - Show or hide bar value. Default: false</li>
  <li>stacked -&nbsp; Stacked? Default: false</li>
  <li>panelSizeRatio - Ratio of the band occupied by the pane.
Default: 0.5 (50%)</li>
  <li>barSizeRatio - In multiple series, percentage of inner band
occupied by bars. Default: 0.5 (50%)</li>
  <li>maxBarSize - Maximum size of a bar in pixels. Default: 2000</li>
</ul>

<h4>Axis properties</h4>
<ul>
  <li>show{X,Y}Scale (true | false) - whether to show an axis. Default: true</li>
  <li>secondAxis (true | false) - whether to show the second axis. Default: false</li>
  <li>xAxisPosition (bottom | top) - the position of the X axis. Default: bottom</li>
  <li>yAxisPosition (left | right) - the position of the Y axis. Default: left</li>
  <li>{x,y}AxisSize - the size of <i>free dimension</i> of an axis (X: height, Y: width). Default: 30</li>
  <li>{x,y}AxisFullGrid (true | false) - show lines on all (major) ticks, except the first and the last. Default: false</li>
  <li>{x,y}AxisEndLine (true | false) - show a line on the last (major) tick. Default: false</li>
  <li>{x,y,second}AxisTitle - The axis title text. Default: null</li>
  <li>{x,y,second}AxisTitleFont - The axis title font. Default: '10px sans-serif'</li>
  <li>{x,y,second}AxisTitleSize - The size of the axis title.
      The size is the width when the axis is vertical and the height when it is horizontal.
      The title consumes space from the specified {x|y|second}AxisSize.
      Default: The required by the font height plus a proportional margin.</li>
  <li>{x,y,second}AxisDomainRoundMode (none | nice | tick) - rounding mode of the domain bounds of a linear scale axis. Default: none</li>
  <li>{x,y,second}AxisDesiredTickCount - desired number of (major) ticks of a linear scale axis. Default: 5</li>
  <li>{x,y,second}AxisMinorTicks (true|false) - show minor ticks on a linear scale axis. Default: true</li>
  <li>secondAxisIdx - Array of indexes of the series that are shown on the second axis</li>
  <li>secondAxisIndependentScale (true | false) - if the second axis has an independent scale</li>
  <li>secondAxisOriginIsZero (true | false) - if the second axis should show the 0 value at the origin. Default: 0</li>
  <li>secondAxisColor - line and scale color. Default: blue</li>
</ul>

<h2>Extension Points</h2>
The following&nbsp;list&nbsp;serves as the basis
for Waterfall extension points:
<ul>
  <li>base_</li>
  <li>title_</li>
  <li>titleLabel_</li>
  <li>legendArea_</li>
  <li>legendPanel_</li>
  <li>legendRule_</li>
  <li>legendDot_</li>
  <li>legendLabel_</li>
  <li>{x,y}Axis_</li>
  <li>{x,y}AxisRule_</li>
  <li>{x,y}AxisGrid_</li>
  <li>{x,y}AxisScale_</li>
  <li>{x,y}AxisTicks_</li>
  <li>{x,y}AxisMinorTicks_</li>
  <li>{x,y}AxisEndLine_</li>
  <li>{x,y}AxisLabel_</li>
  <li>{x,y}AxisTitleLabel_</li>
  <li>tooltip_</li>
  <li>barLabel_</li>
  <li>barPanel_</li>
  <li>bar_</li>
  <li>chart_</li>
  <li>barWaterfallLine_</li>
</ul>
Sample extension points:<br>
<ul>
  <li>base_fillStyle</li>
  <li>titleLabel_font</li>
  <li>barWaterfallLine_strokeStyle</li>
</ul>

<h2>Examples</h2>
<h3>Sample Waterfall</h3>
On the left side you see the total. 
When you move to the right you see the split of this total across the four sales regions.
In each sales region as well as in the totals column you can also observe a split into two product lines.<br>
<textarea cols="55" rows="20" id="pvcWf1Code">
var wf1 = new pvc.WaterfallChart({
         canvas: "pvcWf1",
         width: 450,
         height: 400,
         title: "Sales by region and product",
         titlePosition: "bottom",
         titleSize: 40,
         legend: true,
         legendPosition: "top",
         legendAlign: "right",
         animate: false,
         clickable: true,
         orientation: 'vertical',
         stacked: true,
         maxBarSize: 100,
         panelSizeRatio:0.75,
         barSizeRatio: 1.0,
         selectable: true,
         showValues: true,
         showXScale: true,
         showYScale: true,
         yAxisPosition: "left",
         yAxisSize: 30,
         xAxisPosition: "bottom",
         xAxisSize: 30,
        
         extensionPoints: {
          titleLabel_font: "16px sans-serif",         
         }
       });

       wf1.setData(testWaterfall_01,
                  {crosstabMode: true,
                   seriesInRows: false});
       wf1.render();
</textarea>
        <button class="tryMe" onclick='tryMe(this)'>Try me</button>
        <div id="pvcWf1"></div>

<h3>Sample horizontal Waterfall</h3>
The example 'Sample Waterfall' with an 'horizontal' orientation.<br>
<textarea cols="55" rows="20" id="pvcWf2Code">
var wf2 = new pvc.WaterfallChart({
    canvas: "pvcWf2",
    width:  400,
    height: 300,
    title:  "Sales by region and product - Horizontal",
    titlePosition: "bottom",
    titleSize: 40,
    legend: true,
    legendPosition: "top",
    legendAlign:    "right",
    animate: false,
    clickable: true,
    orientation: 'horizontal',
    stacked: true,
    maxBarSize: 100,

    panelSizeRatio:0.75,
    barSizeRatio: 1.0,

    showValues: true,
    showXScale: true,
    showYScale: true,
    yAxisPosition: "left",
    yAxisSize: 40,
    xAxisPosition: "bottom",
    xAxisSize: 30,

    extensionPoints: {
        titleLabel_font: "16px sans-serif",         
    }});

wf2.setData(testWaterfall_01, {
    crosstabMode: true,
    seriesInRows: false
});

wf2.render();
</textarea>
        <button class="tryMe" onclick='tryMe(this)'>Try me</button>
        <div id="pvcWf2"></div>

<h3>An Advanced Waterfall</h3>
This chart shows a more advanced example, where we first show the main regions:
 USA, Europe and Rest of World.
Then, the RoW region is in turn split into its different sub-regions.<br>
<textarea cols="55" rows="25" id="pvcWf3Code">
var wf3 = new pvc.WaterfallChart({
    canvas: "pvcWf3",
    width: 450,
    height: 400,
    title: "Sales by region and product - Detailed",
    titlePosition: "bottom",
    titleSize: 40,
    legend: true,
    legendPosition: "top",
    legendAlign: "right",
    animate: false,
    clickable: true,
    orientation: 'vertical',
    stacked: true,
    maxBarSize: 100,

    panelSizeRatio:0.75,
    barSizeRatio: 1,
    margins: 20,
    showValues: true,
    showXScale: true,
    showYScale: true,
    yAxisPosition: "left",
    yAxisSize: 40,
    xAxisPosition: "bottom",
    xAxisSize: 30,

    extensionPoints: {
        titleLabel_font: "16px sans-serif",
        barWaterfallLine_strokeStyle:"red"
    }});

wf3.setData(testWaterfall_02,{
    crosstabMode: true,
    seriesInRows: false
});

wf3.render();
</textarea>
        <button class="tryMe" onclick='tryMe(this)'>Try me</button>
        <div id="pvcWf3"></div>

<h3>An horizontal Advanced Waterfall</h3>
The example 'An Advanced Waterfall' with an 'horizontal' orientation.<br>
<textarea cols="55" rows="25" id="pvcWf4Code">
var wf4 = new pvc.WaterfallChart({
    canvas: "pvcWf4",
    width: 450,
    height: 400,
    title: "Sales by region and product - Detailed - Horizontal",
    titlePosition: "bottom",
    titleSize: 40,
    legend: true,
    legendPosition: "top",
    legendAlign: "right",
    animate: false,
    clickable: true,
    orientation: 'horizontal',
    stacked: true,
    maxBarSize: 100,

    panelSizeRatio:0.75,
    barSizeRatio: 1,

    showValues: true,
    showXScale: true,
    showYScale: true,
    yAxisPosition: "left",
    yAxisSize: 45,
    xAxisPosition: "bottom",
    xAxisSize: 30,
    xAxisFullGrid: true,
    yAxisFullGrid: true,
    xAxisEndLine: true,
    yAxisEndLine: true,

    extensionPoints: {
        titleLabel_font: "16px sans-serif",          
        barWaterfallLine_strokeStyle:"red"
    }});

wf4.setData(testWaterfall_02,{
    crosstabMode: true,
    seriesInRows: false
});

wf4.render();
</textarea>
        <button class="tryMe" onclick='tryMe(this)'>Try me</button>
        <div id="pvcWf4"></div>
  </body>
</html>
